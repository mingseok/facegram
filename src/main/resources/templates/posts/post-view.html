<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments.html :: head"></head>
<body>
<div th:replace="fragments.html :: main-nav"></div>
<div class="container mt-5">
    <div class="row justify-content-md-center">
        <div class="col-sm-8"  style="margin-top: 20px">
            <div class="post-category row" style="color: gray">
                <div class="col" style="text-align: left;">
                    <span>조회수 </span>
                    <span th:text="${post.hit}"></span>
                </div>
                <div class="col" style="text-align: right; margin-right: 3%" >
                    <span th:text="${#temporals.format(post.createdDate,'yyyy-MM-dd HH:mm')}">작성시간</span>
                </div>
            </div>
            <div style="margin-top: 10px">
                <p>제목 : [[${post.title}]]</p>
            </div>
            <div>
                <span th:text="${post.content}">내용</span>
            </div>
        </div>
        <div class="col-sm-4" style="border-left: 1px solid lightgray; margin-top: 5%; width: 365px">
            <div style="margin-left: 7%">
                <div class="row">
                    <div class="col-sm-4 justify-content-center pt-4">
                        <div class="row mx-auto" style="border-radius: 20px;">
                            <div class="col-3">
                                <a th:value="${post.id}" href="javascript:" class="heart-click heart_icon${post.id}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="crimson" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                                    </svg>
                                </a>
                            </div>
                            <div class="col-1">
                                <span style="font-size: 13px; width: 13px; height: 13px" th:id="${post.id}">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4 justify-content-center pt-4">
                        <div class="row mx-auto" style="border-radius: 20px;">
                            <div class="col-3">
                                <a th:value="${post.id}" href="javascript:" class="bookmark-click bookmark_icon${post.id}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="20" fill="currentColor"
                                         class="bi bi-bookmark-fill" viewBox="0 0 16 16">
                                        <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z"/>
                                    </svg>
                                </a>
                            </div>
                            <div class="col-1">
                                <span style="font-size: 13px; width: 13px; height: 13px" th:id="'bookmark'+${post.id}">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="row post-profile" style="margin-top: 3%">
                        <div class="col-sm-2" style="margin-right: 1%">
                            <a th:href="@{'/profile/'+${profile.memberId}}">
                                <img th:if="${#strings.isEmpty(profile?.profileImage)}" class="post-img"
                                     src="/image/profile.png" width="50" height="50"/>
                                <img th:if="${!#strings.isEmpty(profile?.profileImage)}" class="post-img"
                                     th:src="${profile?.profileImage}"
                                     width="50" height="50" alt="name"/>
                            </a>
                        </div>
                        <div class="col-sm" style="text-align: left">
                            <div>
                                <span th:text="${post.writer}" style="font-weight: bold; font-size: 15px">닉네임</span>
                            </div>
                            <div>
                                <span th:text="${profile?.bio}" style="font-size: 11px; color: gray">한줄소개</span>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <button type="button" class="btn btn-primary followBtn" style="width: 80px;">팔로우</button>
                        </div>
                    </div>
                </div>
        </div>
    </div>
    <div style="width: 300px">
        <button id="update" class="btn btn-outline-primary" type="button">
            <a th:href="@{'/update/' + ${post.id}}">수정</a>
        </button>
        <button id="delete" class="btn btn-danger delete-btn" type="button" th:value="${post.id}">삭제</button>
    </div>
</div>
</div>

<script type="application/javascript" th:inline="javascript">

    $(document).on("click", ".delete-btn", function () {

        let header = [[${_csrf.headerName}]];
        let token = [[${_csrf.token}]];
        let id = $(".delete-btn").val();

        $.ajax({
            url: '/delete/' + id,
            type: 'delete',
            success: function (data) {
                window.location.replace(data);
            },
            beforeSend: function (xhr) {
                xhr.setRequestHeader(header, token);
            },
        });

    })

</script>
</body>

</html>